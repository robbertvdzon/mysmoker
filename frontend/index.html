<html>
<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript">

        var smokerAPI = "https://mysmoker.api.vdzon.com/lastsession";

        $.get(smokerAPI, function (tempdata) {
            var lastUpdate = new Date(tempdata.lastSampleTime)
            var lastUpdateString = lastUpdate.getHours() + ":" + lastUpdate.getMinutes()+":"+lastUpdate.getSeconds();
            $("#sessionDateId").text(tempdata.sessionDateTime);
            $("#statusId").text("smoker:"+tempdata.lastBbqTemp+"("+tempdata.lastBbqSet+") temp, vlees:"+tempdata.lastMeatTemp+", zuurstofdoorvoer op "+tempdata.lastFan+"%");
            $("#lastUpdateId").text("Laatste geupdate om "+lastUpdateString);

            var arr = [];
            arr.push(['Tijd', 'Temp', 'Fan', 'Set', 'Meat']);

            var arrayLength = tempdata.samples.length;
            for (var i = 0; i < arrayLength; i++) {
                var temp = tempdata.samples[i];
                arr.push([new Date(temp.t),temp.bt,temp.f,temp.bs,temp.mt]);
            }
            var data = google.visualization.arrayToDataTable(arr);
            var options = {
                title: 'Smoker',
                curveType: 'function',
                hAxis: {
                    title: 'Tijd',
                    slantedText: true, slantedTextAngle: 80
                },
                vAxis: {minValue: 80},
                explorer: {
                    actions: ['dragToZoom', 'rightClickToReset'],
                    axis: 'horizontal',
                    keepInBounds: true,
                    maxZoomIn: 4.0
                }
            };

            var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
            chart.draw(data, options);

            view = new google.visualization.DataView(data);
            view.hideColumns([2]);
            chart.draw(view, options);

            var hideSal = document.getElementById("hideSales");
            hideSal.onclick = function () {
                view = new google.visualization.DataView(data);
                view.hideColumns([1, 3, 4]);
                chart.draw(view, options);
            }
            var hideExp = document.getElementById("hideExpenses");
            hideExp.onclick = function () {
                view = new google.visualization.DataView(data);
                view.hideColumns([2]);
                chart.draw(view, options);
            }
            var all = document.getElementById("all");
            all.onclick = function () {
                view = new google.visualization.DataView(data);
                chart.draw(view, options);
            }

        });

        google.charts.load('current', {'packages': ['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {


        }
    </script>
</head>
<body>

<div style="text-align: center;">
    <div style="width: 100%; margin: 0 auto;"><h1>
        <span id="sessionDateId"></span>
    </h1></div>
    <div style="width: 100%; margin: 0 auto;">
        <span id="lastUpdateId"></span>
        <br>
        <span id="statusId"></span>
    </div>

</div>


<div id="chart_div" style="width: 100%; height: 500px"></div>
<div style="text-align: center;">
    <div style="width: 500px; margin: 0 auto;">
        <h1>
            <button type="button" id="hideSales">Alleen ventilator</button>
            <button type="button" id="hideExpenses">Alleen temp</button>
            <button type="button" id="all">Beide</button>
        </h1>
    </div>
</div>
</body>
</html>